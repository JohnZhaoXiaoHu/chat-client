(window.webpackJsonp = window.webpackJsonp || []).push([['sound-record'], { '1ee0': function (e, t, n) { 'use strict'; n.d(t, 'a', function () { return a }), n.d(t, 'b', function () { return r }); n('d3b7'), n('ac1f'), n('3ca3'), n('5319'), n('ddb0'), n('2b3d'), n('96cf'); var i = n('1da1'); function a (e, t) { if (!e) return Promise.reject(Error(t)); var n = (new Date()).toISOString().replace('T', ' '); var i = document.createElement('a'); return i.href = URL.createObjectURL(e), i.setAttribute('download', ''.concat(n, '.mp3')), i.click(), Promise.resolve() } function r (e, t) { if (!e) return Promise.reject(t); var n = new FileReader(); return n.onload = Object(i.a)(regeneratorRuntime.mark(function e () { var t, i; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0:return t = new AudioContext(), i = t.createBufferSource(), e.next = 4, t.decodeAudioData(n.result); case 4:i.buffer = e.sent, i.connect(t.destination), i.start(0); case 7:case 'end':return e.stop() } }, e) })), n.readAsArrayBuffer(e), Promise.resolve() } }, 2677: function (e, t, n) { 'use strict'; var i = n('8654'); t.a = i.a }, 5803: function (e, t, n) {}, '60bd': function (e, t, n) { e.exports = { inner: 'sound-record_inner_1HaY0' } }, '8adc': function (e, t, n) {}, a434: function (e, t, n) { 'use strict'; var i = n('23e7'); var a = n('23cb'); var r = n('a691'); var o = n('50c4'); var s = n('7b0b'); var c = n('65f0'); var l = n('8418'); var u = n('1dde'); var h = n('ae40'); var d = u('splice'); var p = h('splice', { ACCESSORS: !0, 0: 0, 1: 2 }); var f = Math.max; var v = Math.min; var b = 9007199254740991; var g = 'Maximum allowed length exceeded'; i({ target: 'Array', proto: !0, forced: !d || !p }, { splice: function (e, t) { var n; var i; var u; var h; var d; var p; var m = s(this); var y = o(m.length); var w = a(e, y); var S = arguments.length; if (S === 0 ? n = i = 0 : S === 1 ? (n = 0, i = y - w) : (n = S - 2, i = v(f(r(t), 0), y - w)), y + n - i > b) throw TypeError(g); for (u = c(m, i), h = 0; h < i; h++)d = w + h, d in m && l(u, h, m[d]); if (u.length = i, n < i) { for (h = w; h < y - i; h++)d = h + i, p = h + n, d in m ? m[p] = m[d] : delete m[p]; for (h = y; h > y - i + n; h--) delete m[h - 1] } else if (n > i) for (h = y - i; h > w; h--)d = h + i - 1, p = h + n - 1, d in m ? m[p] = m[d] : delete m[p]; for (h = 0; h < n; h++)m[h + w] = arguments[h + 2]; return m.length = y - i + n, u } }) }, e598: function (e, t, n) { 'use strict'; var i = n('60bd'); var a = n.n(i); n.d(t, 'default', function () { return a.a }) }, f984: function (e, t, n) { 'use strict'; n.r(t); var i = function () { var e = this; var t = e.$createElement; var n = e._self._c || t; return n('div', { class: e.$style.inner }, [n('v-file-input', { on: { change: e.onChange } }), n('v-btn', { on: { click: function (t) { e.audioData.length === 0 ? e.record() : e.stopRecord() } } }, [e._v(e._s(e.audioData.length === 0 ? '录制' : '停止录制'))]), n('v-btn', { on: { click: e.playAudio } }, [e._v('播放录音')]), n('v-btn', { on: { click: e.downloadToLocal } }, [e._v('保存为本地音乐文件')])], 1) }; var a = []; var r = (n('4160'), n('b0c0'), n('ac1f'), n('5319'), n('159b'), n('96cf'), n('1da1')); var o = n('d4ec'); var s = n('bee2'); var c = n('262e'); var l = n('2caf'); var u = n('9ab4'); var h = n('1b40'); var d = n('1ee0'); var p = (function (e) { Object(c.a)(n, e); var t = Object(l.a)(n); function n () { var e; return Object(o.a)(this, n), e = t.apply(this, arguments), e.audioData = [], e.currentFile = null, e } return Object(s.a)(n, [{ key: 'record', value: (function () { var e = Object(r.a)(regeneratorRuntime.mark(function e () { var t; var n; var i = this; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0:return e.prev = 0, e.next = 3, navigator.mediaDevices.getUserMedia({ audio: { sampleRate: 48e3, channelCount: 2 }, video: !1 }); case 3:t = this.mediaStream = e.sent, n = this.recorder = new MediaRecorder(t, { audioBitsPerSecond: 256e3, mimeType: 'audio/webm' }), n.ondataavailable = (function () { var e = Object(r.a)(regeneratorRuntime.mark(function e (t) { return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0:console.log(t.data), i.audioData.push(t.data); case 2:case 'end':return e.stop() } }, e) })); return function (t) { return e.apply(this, arguments) } }()), n.onstop = function () { var e = (new Date()).toISOString().replace('T', ' '); i.currentFile = new File(i.audioData, ''.concat(e, '.mp3'), { type: 'audio/mpeg' }), i.audioData = [] }, n.start(10), e.next = 13; break; case 10:e.prev = 10, e.t0 = e.catch(0), e.t0.name === 'TypeError' ? alert('当前环境不支持视频通话') : e.t0.name === 'NotAllowedError' ? alert('请允许使用麦克风') : e.t0.name === 'AbortError' ? console.log('中止') : e.t0.name === 'NotFoundError' ? console.log('找不到') : e.t0.name === 'OverConstrainedError' ? console.log('设备无法满足要求') : e.t0.name === 'SecurityError' && console.log('由于安全原因，被禁止'); case 13:case 'end':return e.stop() } }, e, this, [[0, 10]]) })); function t () { return e.apply(this, arguments) } return t }()) }, { key: 'stopRecord', value: function () { var e = this.mediaStream; e.getTracks().forEach(function (e) { e.stop() }), this.recorder.stop() } }, { key: 'downloadToLocal', value: (function () { var e = Object(r.a)(regeneratorRuntime.mark(function e () { var t; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0:return e.prev = 0, t = this.currentFile, e.next = 4, Object(d.a)(t, '请先录制完成，再下载'); case 4:e.next = 9; break; case 6:e.prev = 6, e.t0 = e.catch(0), alert(e.t0); case 9:case 'end':return e.stop() } }, e, this, [[0, 6]]) })); function t () { return e.apply(this, arguments) } return t }()) }, { key: 'playAudio', value: (function () { var e = Object(r.a)(regeneratorRuntime.mark(function e () { var t; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0:return e.prev = 0, t = this.currentFile, e.next = 4, Object(d.b)(t, '请先录制完成，再播放'); case 4:e.next = 9; break; case 6:e.prev = 6, e.t0 = e.catch(0), alert(e.t0); case 9:case 'end':return e.stop() } }, e, this, [[0, 6]]) })); function t () { return e.apply(this, arguments) } return t }()) }, { key: 'onChange', value: function (e) { console.log(e); var t = new FileReader(); t.onload = Object(r.a)(regeneratorRuntime.mark(function e () { var n, i; return regeneratorRuntime.wrap(function (e) { while (1) switch (e.prev = e.next) { case 0:return n = new AudioContext(), i = n.createBufferSource(), e.next = 4, n.decodeAudioData(t.result); case 4:i.buffer = e.sent, i.connect(n.destination), i.start(0); case 7:case 'end':return e.stop() } }, e) })), t.readAsArrayBuffer(e) } }, { key: 'mounted', value: function () { MediaRecorder || alert('请使用最新版本的火狐、谷歌、Edge浏览器') } }]), n }(h.d)); p = Object(u.a)([h.a], p); var f = p; var v = f; var b = n('e598'); var g = n('2877'); var m = n('6544'); var y = n.n(m); var w = n('8336'); var S = (n('99af'), n('a623'), n('caad'), n('d81d'), n('13d5'), n('fb6a'), n('a434'), n('a9e3'), n('2909')); var x = n('5530'); var C = n('53ca'); var O = (n('5803'), n('2677')); var j = (n('4de4'), n('3835')); var k = (n('8adc'), n('58df')); var $ = n('0789'); var B = n('9d26'); var V = n('a9ad'); var R = n('4e82'); var A = n('7560'); var E = n('f2e7'); var D = n('1c87'); var _ = n('af2b'); var z = n('d9bd'); var I = Object(k.a)(V.a, _.a, D.a, A.a, Object(R.a)('chipGroup'), Object(E.b)('inputValue')).extend({ name: 'v-chip', props: { active: { type: Boolean, default: !0 }, activeClass: { type: String, default: function () { return this.chipGroup ? this.chipGroup.activeClass : '' } }, close: Boolean, closeIcon: { type: String, default: '$delete' }, closeLabel: { type: String, default: '$vuetify.close' }, disabled: Boolean, draggable: Boolean, filter: Boolean, filterIcon: { type: String, default: '$complete' }, label: Boolean, link: Boolean, outlined: Boolean, pill: Boolean, tag: { type: String, default: 'span' }, textColor: String, value: null }, data: function () { return { proxyClass: 'v-chip--active' } }, computed: { classes: function () { return Object(x.a)(Object(x.a)(Object(x.a)(Object(x.a)({ 'v-chip': !0 }, D.a.options.computed.classes.call(this)), {}, { 'v-chip--clickable': this.isClickable, 'v-chip--disabled': this.disabled, 'v-chip--draggable': this.draggable, 'v-chip--label': this.label, 'v-chip--link': this.isLink, 'v-chip--no-color': !this.color, 'v-chip--outlined': this.outlined, 'v-chip--pill': this.pill, 'v-chip--removable': this.hasClose }, this.themeClasses), this.sizeableClasses), this.groupClasses) }, hasClose: function () { return Boolean(this.close) }, isClickable: function () { return Boolean(D.a.options.computed.isClickable.call(this) || this.chipGroup) } }, created: function () { var e = this; var t = [['outline', 'outlined'], ['selected', 'input-value'], ['value', 'active'], ['@input', '@active.sync']]; t.forEach(function (t) { var n = Object(j.a)(t, 2); var i = n[0]; var a = n[1]; e.$attrs.hasOwnProperty(i) && Object(z.a)(i, a, e) }) }, methods: { click: function (e) { this.$emit('click', e), this.chipGroup && this.toggle() }, genFilter: function () { var e = []; return this.isActive && e.push(this.$createElement(B.a, { staticClass: 'v-chip__filter', props: { left: !0 } }, this.filterIcon)), this.$createElement($.a, e) }, genClose: function () { var e = this; return this.$createElement(B.a, { staticClass: 'v-chip__close', props: { right: !0, size: 18 }, attrs: { 'aria-label': this.$vuetify.lang.t(this.closeLabel) }, on: { click: function (t) { t.stopPropagation(), t.preventDefault(), e.$emit('click:close'), e.$emit('update:active', !1) } } }, this.closeIcon) }, genContent: function () { return this.$createElement('span', { staticClass: 'v-chip__content' }, [this.filter && this.genFilter(), this.$slots.default, this.hasClose && this.genClose()]) } }, render: function (e) { var t = [this.genContent()]; var n = this.generateRouteLink(); var i = n.tag; var a = n.data; a.attrs = Object(x.a)(Object(x.a)({}, a.attrs), {}, { draggable: this.draggable ? 'true' : void 0, tabindex: this.chipGroup && !this.disabled ? 0 : a.attrs.tabindex }), a.directives.push({ name: 'show', value: this.active }), a = this.setBackgroundColor(this.color, a); var r = this.textColor || this.outlined && this.color; return e(i, this.setTextColor(r, a), t) } }); var T = n('80d2'); var F = n('d9f7'); var L = O.a.extend({ name: 'v-file-input', model: { prop: 'value', event: 'change' }, props: { chips: Boolean, clearable: { type: Boolean, default: !0 }, counterSizeString: { type: String, default: '$vuetify.fileInput.counterSize' }, counterString: { type: String, default: '$vuetify.fileInput.counter' }, hideInput: Boolean, placeholder: String, prependIcon: { type: String, default: '$file' }, readonly: { type: Boolean, default: !1 }, showSize: { type: [Boolean, Number], default: !1, validator: function (e) { return typeof e === 'boolean' || [1e3, 1024].includes(e) } }, smallChips: Boolean, truncateLength: { type: [Number, String], default: 22 }, type: { type: String, default: 'file' }, value: { default: void 0, validator: function (e) { return Object(T.w)(e).every(function (e) { return e != null && Object(C.a)(e) === 'object' }) } } }, computed: { classes: function () { return Object(x.a)(Object(x.a)({}, O.a.options.computed.classes.call(this)), {}, { 'v-file-input': !0 }) }, computedCounterValue: function () { var e = this.isMultiple && this.lazyValue ? this.lazyValue.length : this.lazyValue instanceof File ? 1 : 0; if (!this.showSize) return this.$vuetify.lang.t(this.counterString, e); var t = this.internalArrayValue.reduce(function (e, t) { var n = t.size; var i = void 0 === n ? 0 : n; return e + i }, 0); return this.$vuetify.lang.t(this.counterSizeString, e, Object(T.o)(t, this.base === 1024)) }, internalArrayValue: function () { return Object(T.w)(this.internalValue) }, internalValue: { get: function () { return this.lazyValue }, set: function (e) { this.lazyValue = e, this.$emit('change', this.lazyValue) } }, isDirty: function () { return this.internalArrayValue.length > 0 }, isLabelActive: function () { return this.isDirty }, isMultiple: function () { return this.$attrs.hasOwnProperty('multiple') }, text: function () { var e = this; return this.isDirty ? this.internalArrayValue.map(function (t) { var n = t.name; var i = void 0 === n ? '' : n; var a = t.size; var r = void 0 === a ? 0 : a; var o = e.truncateText(i); return e.showSize ? ''.concat(o, ' (').concat(Object(T.o)(r, e.base === 1024), ')') : o }) : [this.placeholder] }, base: function () { return typeof this.showSize !== 'boolean' ? this.showSize : void 0 }, hasChips: function () { return this.chips || this.smallChips } }, watch: { readonly: { handler: function (e) { !0 === e && Object(z.b)('readonly is not supported on <v-file-input>', this) }, immediate: !0 }, value: function (e) { var t = this.isMultiple ? e : e ? [e] : []; Object(T.h)(t, this.$refs.input.files) || (this.$refs.input.value = '') } }, methods: { clearableCallback: function () { this.internalValue = this.isMultiple ? [] : null, this.$refs.input.value = '' }, genChips: function () { var e = this; return this.isDirty ? this.text.map(function (t, n) { return e.$createElement(I, { props: { small: e.smallChips }, on: { 'click:close': function () { var t = e.internalValue; t.splice(n, 1), e.internalValue = t } } }, [t]) }) : [] }, genControl: function () { var e = O.a.options.methods.genControl.call(this); return this.hideInput && (e.data.style = Object(F.c)(e.data.style, { display: 'none' })), e }, genInput: function () { var e = O.a.options.methods.genInput.call(this); return delete e.data.domProps.value, delete e.data.on.input, e.data.on.change = this.onInput, [this.genSelections(), e] }, genPrependSlot: function () { var e = this; if (!this.prependIcon) return null; var t = this.genIcon('prepend', function () { e.$refs.input.click() }); return this.genSlot('prepend', 'outer', [t]) }, genSelectionText: function () { var e = this.text.length; return e < 2 ? this.text : this.showSize && !this.counter ? [this.computedCounterValue] : [this.$vuetify.lang.t(this.counterString, e)] }, genSelections: function () { var e = this; var t = []; return this.isDirty && this.$scopedSlots.selection ? this.internalArrayValue.forEach(function (n, i) { e.$scopedSlots.selection && t.push(e.$scopedSlots.selection({ text: e.text[i], file: n, index: i })) }) : t.push(this.hasChips && this.isDirty ? this.genChips() : this.genSelectionText()), this.$createElement('div', { staticClass: 'v-file-input__text', class: { 'v-file-input__text--placeholder': this.placeholder && !this.isDirty, 'v-file-input__text--chips': this.hasChips && !this.$scopedSlots.selection } }, t) }, genTextFieldSlot: function () { var e = this; var t = O.a.options.methods.genTextFieldSlot.call(this); return t.data.on = Object(x.a)(Object(x.a)({}, t.data.on || {}), {}, { click: function () { return e.$refs.input.click() } }), t }, onInput: function (e) { var t = Object(S.a)(e.target.files || []); this.internalValue = this.isMultiple ? t : t[0], this.initialValue = this.internalValue }, onKeyDown: function (e) { this.$emit('keydown', e) }, truncateText: function (e) { if (e.length < Number(this.truncateLength)) return e; var t = Math.floor((Number(this.truncateLength) - 1) / 2); return ''.concat(e.slice(0, t), '…').concat(e.slice(e.length - t)) } } }); function M (e) { this.$style = b.default.locals || b.default } var P = Object(g.a)(v, i, a, !1, M, null, null); t.default = P.exports; y()(P, { VBtn: w.a, VFileInput: L }) } }])
// # sourceMappingURL=sound-record.f0d3ed10.js.map
